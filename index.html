<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Dimka's Planner</title>

    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div class="calendar" id="calendar">
        <header>
            <img src="assets/logo.svg" class="header-img" alt="">
        </header>
        <div class="month-navigation">
            <button id="prev-month" class="nav-button">&laquo;</button>
            <span id="current-month" class="current-month">January 2024</span>
            <button id="next-month" class="nav-button">&raquo;</button>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Пн</th>
                    <th>Вт</th>
                    <th>Ср</th>
                    <th>Чт</th>
                    <th>Пт</th>
                    <th>Сб</th>
                    <th>Вс</th>
                </tr>
            </thead>
            <tbody id="calendar-body"></tbody>
        </table>
    </div>

    <div class="planner-page" id="planner-page">
        <button id="back-button" class="back-button">&laquo;</button>
        <span id="selected-date" class="selected-date">January 2024</span>

        <div class="buttons">
            <button class="add-plan">Добавить</button>
            <button id="delete-plan" class="delete-plan">Удалить</button>
        </div>

        <table class="planner-table">
            <tbody id="planner-body" class="planner-body"></tbody>
        </table>
    </div>

    <div class="modal-overlay" id="modal-overlay"></div>
    <div class="modal" id="modal">
        <button class="close-modal-btn" id="close-modal-btn">Закрыть</button>
        <h2>Форма</h2>
        <form id="modal-form">
            <div class="time-group">
                <input type="time" id="start_time" placeholder="Время начала" required step="3600">
                <input type="time" id="end_time" placeholder="Время окончания" required step="3600">
            </div>
            <input type="text" id="plan_name" placeholder="Название" required>
            <button id="order">Отправить</button>
        </form>
    </div>

    <script src="./script.js" defer></script>
    <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        let openModalBtn = document.querySelector(".add-plan");
        let closeModalBtn = document.getElementById("close-modal-btn");
        let modal = document.getElementById("modal");
        let modalOverlay = document.getElementById("modal-overlay");
        let submit = document.getElementById("order");

        // Открыть модальное окно
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "block";
            modalOverlay.style.display = "block";
        });

        // Закрыть модальное окно
        closeModalBtn.addEventListener("click", () => {
            modal.style.display = "none";
            modalOverlay.style.display = "none";
        });

        // Закрыть модальное окно при клике на фон
        modalOverlay.addEventListener("click", () => {
            modal.style.display = "none";
            modalOverlay.style.display = "none";
        });

        submit.addEventListener("click", () => {
            // modal.style.display = "none";
            // modalOverlay.style.display = "none";

            // let start_time = document.getElementById("start_time").value;
            // let end_time = document.getElementById("end_time").value;
            let plan_name = document.getElementById("plan_name").value;

            let data = {
                // day: IdParts[0],
                // month: IdParts[1],
                // year: IdParts[2],
                start_time: start_time,
                end_time: end_time,
                plan_name: plan_name
            }

            tg.sendData(JSON.stringify(data));

            tg.close();
        });
    </script>
</body>
</html>
